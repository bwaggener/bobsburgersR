library(bobsburgersR)
source("C:/Users/poncest/OneDrive - Bristol Myers Squibb/RStudio/bobsburgersR/scrap.R", echo=TRUE)
devtools::install()
library(tidyverse)
library(bobsburgersR)
data(heatmap_data)
data("imdb_wikipedia_data")
glimpse(imdb_wikipedia_data)
data("imdb_wikipedia_data")
glimpse(imdb_wikipedia_data)
ggplot(imdb_wikipedia_data, aes(x = factor(season), y = rating)) +
geom_bar(stat = "summary", fun = "mean", fill = "#92C5DE") +
labs(x = "Season", y = "Average IMDb Rating", title = "Average IMDb Rating by Season")
ggplot(imdb_wikipedia_data, aes(x = imdb_aired_date, y = rating)) +
geom_line(color = "#0571B0") +
labs(x = "Aired Date", y = "IMDb Rating", title = "IMDb Ratings Over Time")
ggplot(imdb_wikipedia_data, aes(x = factor(season), y = rating)) +
geom_boxplot(fill = "#CA0020") +
labs(x = "Season", y = "IMDb Rating", title = "Distribution of IMDb Ratings by Season")
library(reshape2)
imdb_wikipedia_data$episode_combined <- paste(imdb_wikipedia_data$season, imdb_wikipedia_data$episode, sep = "-")
heatmap_data <- dcast(imdb_wikipedia_data, episode_combined ~ imdb_aired_date, value.var = "rating")
heatmap(as.matrix(heatmap_data[,-1]), Colv = NA, scale = "column", col = heat.colors(256))
ggplot(imdb_wikipedia_data, aes(x = wikipedia_directed_by, fill = wikipedia_written_by)) +
geom_bar() +
labs(x = "Director", fill = "Writer", title = "Episodes Directed and Written By")
data("transcript_data")
head(transcript_data)
## Heatmap: Lines Spoken by Season and Episode
# Summarize number of lines per episode per season
heatmap_data <- transcript_data |>
filter(!is.na(dialogue)) |>
group_by(season, episode) |>
summarize(total_lines = n()) |>
ungroup()
# Heatmap: Lines Spoken by Season and Episode
ggplot(heatmap_data, aes(x = as.factor(episode), y = as.factor(season), fill = total_lines)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "lightyellow", high = "red") +
coord_equal() +
labs(
title = "Lines Spoken by Season and Episode",
x = "Episode",
y = "Season",
fill = "Total Lines"
) +
theme_minimal()
